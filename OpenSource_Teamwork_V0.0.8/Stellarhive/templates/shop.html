{% extends 'base.html' %}
{% block content %}
<div class="container py-5">
  <div class="card p-4 mb-4" style="max-width:800px;margin:auto;">
    <h2 class="mb-4 text-center">兑换商店</h2>
    <h4 class="mb-3">头像框（50积分/个）</h4>
    <div class="d-flex flex-wrap gap-3 mb-4">
      {% for i in range(1,6) %}
      <div class="text-center">
        <div style="width:70px;height:70px;border-radius:50%;border:4px solid #{{ ['FFD700','40a9ff','e27a9b','95de64','ff8c00'][i-1] }};margin:auto;"></div>
        <button class="btn btn-outline-primary mt-2" onclick="exchange('avatar_frame', '{{ i }}', 50)">兑换</button>
      </div>
      {% endfor %}
    </div>
    <h4 class="mb-3">昵称颜色（20积分/个）</h4>
    <div class="d-flex flex-wrap gap-3 mb-4">
      {% set colors = ['#e74c3c','#40a9ff','#FFD700','#95de64','#e27a9b','#8e44ad'] %}
      {% for c in colors %}
      <div class="text-center">
        <span style="display:inline-block;width:70px;height:32px;line-height:32px;background:#f8f9fa;border-radius:8px;color:{{ c }};font-weight:bold;">示例昵称</span>
        <button class="btn btn-outline-success mt-2" onclick="exchange('nickname_color', '{{ c }}', 20)">兑换</button>
      </div>
      {% endfor %}
    </div>
    <h4 class="mb-3">昵称字体（30积分/个）</h4>
    <div class="d-flex flex-wrap gap-3 mb-4">
      {% set fonts = ['Arial','Times New Roman','Comic Sans MS','Courier New','Impact','FangSong'] %}
      {% for f in fonts %}
      <div class="text-center">
        <span style="display:inline-block;width:90px;height:32px;line-height:32px;background:#f8f9fa;border-radius:8px;font-family:'{{ f }}';font-size:20px;">示例昵称</span>
        <button class="btn btn-outline-warning mt-2" onclick="exchange('nickname_font', '{{ f }}', 30)">兑换</button>
      </div>
      {% endfor %}
    </div>
  </div>
</div>
<script>
function exchange(type, value, cost) {
  if(!confirm('确定消耗'+cost+'积分兑换该饰品吗？')) return;
  fetch('/exchange', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({type:type, value:value, cost:cost})
  }).then(r=>r.json()).then(d=>{
    if(d.ok){
      alert('兑换成功！');
      location.reload();
    }else{
      alert(d.msg);
    }
  });
}
</script>
{% endblock %}